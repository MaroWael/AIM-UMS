<!--
student.fxml - Student panel UI (Enhanced Modern Design)
Provides tabs for viewing courses, enrolling, taking quizzes, and viewing grades
-->

<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.control.TabPane?>
<?import javafx.scene.control.Tab?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.ComboBox?>
<BorderPane xmlns="http://javafx.com/javafx/21"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.ums.system.controller.StudentController"
            prefHeight="700" prefWidth="1000"
            style="-fx-background-color: linear-gradient(to bottom, #e3f2fd, #f5f5f5);">

    <!-- Top: Enhanced Header with Gradient -->
    <top>
        <VBox style="-fx-background-color: linear-gradient(to right, #1976d2, #2196f3, #42a5f5); -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 10, 0, 0, 2);">
            <padding>
                <Insets top="20" right="25" bottom="20" left="25"/>
            </padding>

            <HBox alignment="CENTER_LEFT" spacing="20">
                <Label fx:id="welcomeLabel" text="Welcome, Student!"
                       style="-fx-text-fill: white; -fx-font-size: 24px; -fx-font-weight: bold; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.3), 5, 0, 0, 1);"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Button text="ðŸšª Logout" onAction="#handleLogout"
                        style="-fx-background-color: white; -fx-text-fill: #1976d2; -fx-font-weight: bold; -fx-padding: 10 25; -fx-cursor: hand; -fx-background-radius: 20; -fx-font-size: 13px; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 5, 0, 0, 2);"/>
            </HBox>

            <Label fx:id="userInfoLabel" text="Role: Student  ID: -  Level: -"
                   style="-fx-text-fill: #e3f2fd; -fx-font-size: 13px; -fx-font-weight: 500;">
                <VBox.margin>
                    <Insets top="8"/>
                </VBox.margin>
            </Label>
        </VBox>
    </top>

    <!-- Center: Enhanced Tab Pane with Modern Styling -->
    <center>
        <TabPane tabClosingPolicy="UNAVAILABLE"
                 style="-fx-padding: 15; -fx-background-color: transparent; -fx-border-color: transparent;">

            <!-- AVAILABLE COURSES TAB -->
            <Tab text="ðŸ“š Available Courses">
                <VBox spacing="20" style="-fx-padding: 25; -fx-background-color: white; -fx-background-radius: 10; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 8, 0, 0, 2);">

                    <Label text="ðŸ“š Available Courses"
                           style="-fx-font-size: 22px; -fx-font-weight: bold; -fx-text-fill: #1976d2;"/>

                    <HBox spacing="12" alignment="CENTER_LEFT"
                          style="-fx-background-color: #e3f2fd; -fx-padding: 15; -fx-background-radius: 8;">
                        <Label text="ðŸ’¡ Browse and enroll in available courses"
                               style="-fx-font-size: 13px; -fx-text-fill: #0d47a1; -fx-font-weight: 500;"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button text="ðŸ”„ Refresh" onAction="#loadAvailableCourses"
                                style="-fx-background-color: #90caf9; -fx-text-fill: #0d47a1; -fx-font-weight: bold; -fx-padding: 10 20; -fx-cursor: hand; -fx-background-radius: 8; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.15), 4, 0, 0, 1);"/>
                        <Button text="âœ… Enroll in Selected" onAction="#handleEnrollCourse"
                                style="-fx-background-color: linear-gradient(to bottom, #4caf50, #388e3c); -fx-text-fill: white; -fx-font-weight: bold; -fx-padding: 10 25; -fx-cursor: hand; -fx-background-radius: 8; -fx-font-size: 13px; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 5, 0, 0, 2);"/>
                    </HBox>

                    <TableView fx:id="availableCoursesTable" VBox.vgrow="ALWAYS"
                               style="-fx-background-color: white; -fx-background-radius: 8; -fx-border-color: #bbdefb; -fx-border-width: 1; -fx-border-radius: 8;">
                        <columns>
                            <TableColumn fx:id="availCourseCodeColumn" text="Code" prefWidth="100"
                                         style="-fx-alignment: CENTER;"/>
                            <TableColumn fx:id="availCourseNameColumn" text="Course Name" prefWidth="250"/>
                            <TableColumn fx:id="availCourseLevelColumn" text="Level" prefWidth="80"
                                        style="-fx-alignment: CENTER;"/>
                            <TableColumn fx:id="availCourseMajorColumn" text="Major" prefWidth="180"/>
                            <TableColumn fx:id="availCourseInstructorColumn" text="Instructor" prefWidth="150"/>
                            <TableColumn fx:id="availCourseLectureTimeColumn" text="Lecture Time" prefWidth="150"/>
                        </columns>
                    </TableView>
                </VBox>
            </Tab>

            <!-- MY COURSES TAB -->
            <Tab text="ðŸ“– My Courses">
                <VBox spacing="20" style="-fx-padding: 25; -fx-background-color: white; -fx-background-radius: 10; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 8, 0, 0, 2);">

                    <Label text="ðŸ“– My Enrolled Courses"
                           style="-fx-font-size: 22px; -fx-font-weight: bold; -fx-text-fill: #1976d2;"/>

                    <HBox spacing="12" alignment="CENTER_LEFT"
                          style="-fx-background-color: #fff3e0; -fx-padding: 15; -fx-background-radius: 8;">
                        <Label text="ðŸ“‹ Courses you are currently enrolled in"
                               style="-fx-font-size: 13px; -fx-text-fill: #e65100; -fx-font-weight: 500;"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button text="ðŸ”„ Refresh" onAction="#loadMyCourses"
                                style="-fx-background-color: #ffcc80; -fx-text-fill: #e65100; -fx-font-weight: bold; -fx-padding: 10 20; -fx-cursor: hand; -fx-background-radius: 8; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.15), 4, 0, 0, 1);"/>
                        <Button text="âŒ Drop Selected" onAction="#handleDropCourse"
                                style="-fx-background-color: linear-gradient(to bottom, #f44336, #d32f2f); -fx-text-fill: white; -fx-font-weight: bold; -fx-padding: 10 25; -fx-cursor: hand; -fx-background-radius: 8; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 5, 0, 0, 2);"/>
                    </HBox>

                    <TableView fx:id="myCoursesTable" VBox.vgrow="ALWAYS"
                               style="-fx-background-color: white; -fx-background-radius: 8; -fx-border-color: #ffe0b2; -fx-border-width: 1; -fx-border-radius: 8;">
                        <columns>
                            <TableColumn fx:id="myCourseCodeColumn" text="Code" prefWidth="100"
                                        style="-fx-alignment: CENTER;"/>
                            <TableColumn fx:id="myCourseNameColumn" text="Course Name" prefWidth="250"/>
                            <TableColumn fx:id="myCourseLevelColumn" text="Level" prefWidth="80"
                                        style="-fx-alignment: CENTER;"/>
                            <TableColumn fx:id="myCourseMajorColumn" text="Major" prefWidth="180"/>
                            <TableColumn fx:id="myCourseInstructorColumn" text="Instructor" prefWidth="150"/>
                            <TableColumn fx:id="myCourseLectureTimeColumn" text="Lecture Time" prefWidth="150"/>
                        </columns>
                    </TableView>
                </VBox>
            </Tab>

            <!-- QUIZZES TAB -->
            <Tab text="ðŸ“ Quizzes">
                <VBox spacing="20" style="-fx-padding: 25; -fx-background-color: white; -fx-background-radius: 10; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 8, 0, 0, 2);">

                    <Label text="ðŸ“ Available Quizzes"
                           style="-fx-font-size: 22px; -fx-font-weight: bold; -fx-text-fill: #1976d2;"/>

                    <HBox spacing="12" alignment="CENTER_LEFT"
                          style="-fx-background-color: #f3e5f5; -fx-padding: 15; -fx-background-radius: 8;">
                        <Label text="ðŸŽ¯ Select Course:"
                               style="-fx-font-weight: bold; -fx-font-size: 13px; -fx-text-fill: #4a148c;"/>
                        <ComboBox fx:id="quizCourseCombo" prefWidth="320" promptText="Choose a course..."
                                  style="-fx-background-color: white; -fx-background-radius: 6; -fx-border-color: #ce93d8; -fx-border-radius: 6; -fx-padding: 8;"/>
                        <Button text="ðŸ” Load Quizzes" onAction="#handleLoadQuizzes"
                                style="-fx-background-color: linear-gradient(to bottom, #9c27b0, #7b1fa2); -fx-text-fill: white; -fx-font-weight: bold; -fx-padding: 10 20; -fx-cursor: hand; -fx-background-radius: 8; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 5, 0, 0, 2);"/>
                        <Button text="ðŸ‘ï¸ View All Quizzes" onAction="#handleViewAllQuizzes"
                                style="-fx-background-color: linear-gradient(to bottom, #2196f3, #1976d2); -fx-text-fill: white; -fx-font-weight: bold; -fx-padding: 10 20; -fx-cursor: hand; -fx-background-radius: 8; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 5, 0, 0, 2);"/>
                    </HBox>

                    <VBox spacing="15" VBox.vgrow="ALWAYS">
                        <HBox spacing="12" alignment="CENTER_LEFT"
                              style="-fx-background-color: linear-gradient(to right, #fff9c4, #fff59d); -fx-padding: 12; -fx-background-radius: 8;">
                            <Label text="ðŸ“‹ Available Quizzes"
                                   style="-fx-font-weight: bold; -fx-font-size: 15px; -fx-text-fill: #f57f17;"/>
                            <Region HBox.hgrow="ALWAYS"/>
                            <Button text="ðŸš€ Take Selected Quiz" onAction="#handleTakeQuiz"
                                    style="-fx-background-color: linear-gradient(to bottom, #ff9800, #f57c00); -fx-text-fill: white; -fx-font-weight: bold; -fx-padding: 12 28; -fx-cursor: hand; -fx-background-radius: 8; -fx-font-size: 14px; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.25), 6, 0, 0, 2);"/>
                        </HBox>

                        <TableView fx:id="quizzesTable" VBox.vgrow="ALWAYS"
                                   style="-fx-background-color: white; -fx-background-radius: 8; -fx-border-color: #e1bee7; -fx-border-width: 1; -fx-border-radius: 8;">
                            <columns>
                                <TableColumn fx:id="quizIdColumn" text="Quiz ID" prefWidth="80"
                                            style="-fx-alignment: CENTER;"/>
                                <TableColumn fx:id="quizTitleColumn" text="Quiz Title" prefWidth="300"/>
                                <TableColumn fx:id="quizCourseColumn" text="Course Code" prefWidth="120"
                                            style="-fx-alignment: CENTER;"/>
                                <TableColumn fx:id="quizCourseNameColumn" text="Course Name" prefWidth="250"/>
                                <TableColumn fx:id="quizQuestionsColumn" text="Total Questions" prefWidth="130"
                                            style="-fx-alignment: CENTER;"/>
                            </columns>
                        </TableView>
                    </VBox>
                </VBox>
            </Tab>

            <!-- MY GRADES TAB -->
            <Tab text="â­ My Grades">
                <VBox spacing="20" style="-fx-padding: 25; -fx-background-color: white; -fx-background-radius: 10; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 8, 0, 0, 2);">

                    <Label text="â­ My Quiz Results"
                           style="-fx-font-size: 22px; -fx-font-weight: bold; -fx-text-fill: #1976d2;"/>

                    <!-- Enhanced Average Score Card -->
                    <HBox spacing="15" alignment="CENTER_LEFT"
                          style="-fx-background-color: linear-gradient(to right, #4caf50, #66bb6a); -fx-padding: 20; -fx-background-radius: 10; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.15), 8, 0, 0, 3);">
                        <Label text="ðŸ“Š" style="-fx-font-size: 32px;"/>
                        <VBox spacing="3">
                            <Label text="Your Performance"
                                   style="-fx-font-size: 13px; -fx-text-fill: #e8f5e9; -fx-font-weight: 500;"/>
                            <Label fx:id="averageScoreLabel" text="Average Score: N/A"
                                   style="-fx-font-size: 20px; -fx-font-weight: bold; -fx-text-fill: white; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 3, 0, 0, 1);"/>
                        </VBox>
                    </HBox>

                    <HBox spacing="12" alignment="CENTER_LEFT"
                          style="-fx-background-color: #e8f5e9; -fx-padding: 15; -fx-background-radius: 8;">
                        <Label text="ðŸ“ˆ All your quiz results and grades"
                               style="-fx-font-size: 13px; -fx-text-fill: #1b5e20; -fx-font-weight: 500;"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button text="ðŸ“„ Generate Report (PDF)" onAction="#handleGenerateReport"
                                style="-fx-background-color: linear-gradient(to bottom, #ff9800, #f57c00); -fx-text-fill: white; -fx-font-weight: bold; -fx-padding: 10 20; -fx-cursor: hand; -fx-background-radius: 8; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 5, 0, 0, 2);"/>
                        <Button text="ðŸ”„ Refresh" onAction="#loadMyGrades"
                                style="-fx-background-color: #a5d6a7; -fx-text-fill: #1b5e20; -fx-font-weight: bold; -fx-padding: 10 20; -fx-cursor: hand; -fx-background-radius: 8; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.15), 4, 0, 0, 1);"/>
                        <Button text="ðŸ” View Details" onAction="#handleViewGradeDetails"
                                style="-fx-background-color: linear-gradient(to bottom, #2196f3, #1976d2); -fx-text-fill: white; -fx-font-weight: bold; -fx-padding: 10 20; -fx-cursor: hand; -fx-background-radius: 8; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 5, 0, 0, 2);"/>
                    </HBox>

                    <TableView fx:id="gradesTable" VBox.vgrow="ALWAYS"
                               style="-fx-background-color: white; -fx-background-radius: 8; -fx-border-color: #c8e6c9; -fx-border-width: 1; -fx-border-radius: 8;">
                        <columns>
                            <TableColumn fx:id="gradeQuizTitleColumn" text="Quiz Title" prefWidth="250"/>
                            <TableColumn fx:id="gradeCourseColumn" text="Course" prefWidth="200"/>
                            <TableColumn fx:id="gradeScoreColumn" text="Score (%)" prefWidth="100"
                                        style="-fx-alignment: CENTER;"/>
                            <TableColumn fx:id="gradeTotalQuestionsColumn" text="Total Questions" prefWidth="120"
                                        style="-fx-alignment: CENTER;"/>
                            <TableColumn fx:id="gradeAnswersColumn" text="Correct Answers" prefWidth="120"
                                        style="-fx-alignment: CENTER;"/>
                        </columns>
                    </TableView>
                </VBox>
            </Tab>

        </TabPane>
    </center>

</BorderPane>
